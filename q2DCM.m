function dcm = q2DCM(q)
q2 = q.^2;
dcm = [q2(4)+q2(1)-q2(2)-q2(3),2*(q(1)*q(2)+q(3)*q(4)),2*(q(1)*q(3)-q(2)*q(4));
       2*(q(1)*q(2)-q(3)*q(4)),q2(4)-q2(1)+q2(2)-q2(3),2*(q(2)*q(3)+q(1)*q(4));
       2*(q(1)*q(3)+q(2)*q(4)),2*(q(2)*q(3)-q(1)*q(4)),q2(4)-q2(1)-q2(2)+q2(3)];
end
